"use strict";(self["webpackChunkjiang_blog"]=self["webpackChunkjiang_blog"]||[]).push([[231],{5231:function(s,t,e){e.r(t),e.d(t,{default:function(){return v}});var i=function(){var s=this,t=s._self._c;return t("div",{staticClass:"message"},[s._m(0),t("el-divider",{staticClass:"message-divider",attrs:{"content-position":"left"}},[s._v("留言区")]),t("div",{staticClass:"message-content"},[t("el-alert",{attrs:{title:"友善发言，维护良好的互联网环境",type:"warning"}}),t("div",{staticClass:"message-content-show"},[t("div",{staticClass:"infinite-list-wrapper",staticStyle:{overflow:"auto"}},[t("ul",{directives:[{name:"infinite-scroll",rawName:"v-infinite-scroll",value:s.load,expression:"load"}],class:["infinite-list","message-content-show-ul"],attrs:{"infinite-scroll-disabled":"disabled"}},s._l(s.publishMessage,(function(e){return t("li",{key:e._id,staticClass:"message-content-show-ul-list"},[t("div",{staticClass:"message-content-show-ul-list-content"},[t("div",{staticClass:"message-content-show-ul-list-content-avatar"},[e.userAbout?t("img",{attrs:{src:e.userAbout.userAvatar,alt:""}}):t("img",{attrs:{src:s.$store.state.userInfo.userAvatar,alt:""}})]),t("div",{staticClass:"message-content-show-ul-list-content-message"},[t("div",[t("span",{staticClass:"name"},[s._v(s._s(e.userAbout.username?e.userAbout.username:s.$store.state.userInfo.username))]),t("span",{staticClass:"time"},[s._v(s._s(s._f("timer")(e.publishDate)))])]),t("p",[s._v(s._s(e.guestbook))])])])])})),0),s.loading?t("p",{staticClass:"tip"},[s._v("加载中...")]):s._e(),s.noMore?t("p",{staticClass:"tip"},[s._v(s._s(s.tips))]):s._e()])]),t("div",{staticClass:"message-content-write"},[t("i",{staticClass:"el-icon-chat-dot-round"}),t("input",{directives:[{name:"model",rawName:"v-model",value:s.inputMessage,expression:"inputMessage"}],ref:"inputbox",staticClass:"message-content-write-input",attrs:{placeholder:"说点好听的..."},domProps:{value:s.inputMessage},on:{input:function(t){t.target.composing||(s.inputMessage=t.target.value)}}}),t("el-popover",{attrs:{placement:"bottom-end",width:"200",trigger:"click"}},[t("el-button",{attrs:{slot:"reference"},slot:"reference"},[t("b",[s._v("😀")])]),t("el-tabs",{staticStyle:{cursor:"pointer"},model:{value:s.activeName,callback:function(t){s.activeName=t},expression:"activeName"}},[t("el-tab-pane",{attrs:{label:"😀",name:"first"}},[t("Emoji",{attrs:{emoji:s.emoji},on:{chooseEmoji:s.chooseEmoji}})],1),t("el-tab-pane",{attrs:{label:"⚽️",name:"second"}},[t("Emoji",{attrs:{emoji:s.movement},on:{chooseEmoji:s.chooseEmoji}})],1),t("el-tab-pane",{attrs:{label:"🐶",name:"third"}},[t("Emoji",{attrs:{emoji:s.animal},on:{chooseEmoji:s.chooseEmoji}})],1),t("el-tab-pane",{attrs:{label:"🍏",name:"fourth"}},[t("Emoji",{attrs:{emoji:s.eat},on:{chooseEmoji:s.chooseEmoji}})],1),t("el-tab-pane",{attrs:{label:"🚗",name:"fourth1"}},[t("Emoji",{attrs:{emoji:s.traffic},on:{chooseEmoji:s.chooseEmoji}})],1)],1)],1),t("i",{staticClass:"el-icon-position",on:{click:s.sendMessage}})],1)],1)],1)},a=[function(){var s=this,t=s._self._c;return t("div",{staticClass:"message-title"},[t("h3",[t("i",{staticClass:"el-icon-s-comment"}),s._v("留言")])])}],o=function(){var s=this,t=s._self._c;return t("div",{staticClass:"emoji"},s._l(s.emoji,(function(e,i){return t("b",{key:i,on:{click:function(t){return s.chooseEmoji(e)}}},[s._v(s._s(e))])})),0)},n=[],r={name:"Emoji",props:["emoji"],methods:{chooseEmoji(s){this.$emit("chooseEmoji",s)}}},l=r,c=e(1001),u=(0,c.Z)(l,o,n,!1,null,"15fd59fe",null),m=u.exports,h=e(9158),d=e(629),p={name:"Message",data(){return{inputMessage:"",activeName:"first",publishMessage:[],count:0,loading:!1,tips:"没有更多了~"}},mounted(){this.showAllMessage()},methods:{chooseEmoji(s){const t=this.$refs.inputbox.selectionStart;this.inputMessage=this.inputMessage.substring(0,t)+s+this.inputMessage.substring(t),this.$refs.inputbox.focus()},async sendMessage(){if(!this.$store.state.userInfo._id)return this.$message.error("请先登录账号");if(!this.inputMessage.trim())return this.$message.warning("请输入留言内容");const{data:s}=await(0,h.oi)({id:this.$store.state.userInfo._id,message:this.inputMessage});s.data.userAbout=this.$store.state.userInfo,this.publishMessage.unshift(s.data),this.inputMessage=""},async showAllMessage(s=0){if(!this.$store.state.userInfo._id)return this.tips="登录账号才能查看";const{data:t}=await(0,h.SO)(s);this.publishMessage.push(...t.data),this.loading=!1},load(){this.loading=!0,this.count+=10,this.showAllMessage(this.count)}},computed:{...(0,d.rn)(["emoji","movement","animal","eat","traffic","userInfo"]),noMore(){return this.count>=this.publishMessage.length},disabled(){return this.loading||this.noMore}},components:{Emoji:m}},g=p,f=(0,c.Z)(g,i,a,!1,null,"e15fd500",null),v=f.exports}}]);
//# sourceMappingURL=231.83d1fa7a.js.map